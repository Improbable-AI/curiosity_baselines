#include "OnlineFuzzyArt.h"
#include "types.h"
#include <glog/logging.h>
#include <iostream>


int main(int argc, char **argv)
{
    google::InitGoogleLogging(argv[0]);
    google::InstallFailureSignalHandler();

    art::Matrix features(20, 16);
    features << 9.296160928171478544e-01, 3.163755545817859005e-01, 1.839188116770944514e-01, 2.045602785530397094e-01, 5.677250290816866496e-01, 5.955447029792515501e-01, 9.645145197356216338e-01, 6.531770968715708836e-01, 7.489066375339118453e-01, 6.535698708517353461e-01, 7.477148092712738725e-01, 9.613067360728213551e-01, 8.388297941553490844e-03, 1.064443766977193340e-01, 2.987037137693815403e-01, 6.564111830822699778e-01,
                8.098125525409347603e-01, 8.721759137242830473e-01, 9.646475973719301766e-01, 7.236853469199534539e-01, 6.424753278958412750e-01, 7.174536208124137060e-01, 4.675990072192964808e-01, 3.255846775393778092e-01, 4.396446058848094696e-01, 7.296890827468514029e-01, 9.940145858999619444e-01, 6.768737117737699815e-01, 7.908225178477885642e-01, 1.709142577924344097e-01, 2.684927578993556718e-02, 8.003702439254607448e-01,
                9.037225382170001042e-01, 2.467621042926526620e-02, 4.917473184458859281e-01, 5.262551673498578886e-01, 5.963660104193805322e-01, 5.195754510253358660e-02, 8.950895280539211685e-01, 7.282661803271173184e-01, 8.183500113899144779e-01, 5.002227528344482810e-01, 8.101894088032547403e-01, 9.596852574456660179e-02, 2.189500437320934800e-01, 2.587190616031125323e-01, 4.681057539529351885e-01, 4.593732026034809124e-01,
                7.095097802091789863e-01, 1.780530058835381180e-01, 5.314498843596340283e-01, 1.677422287864857031e-01, 7.688139184058102593e-01, 9.281705491153227072e-01, 6.094936579935035237e-01, 1.501834946688817007e-01, 4.896267036939954131e-01, 3.773449538332256381e-01, 8.486014119777788300e-01, 9.110972286316726398e-01, 3.838487211572885194e-01, 3.154959033961238779e-01, 5.683941527954240458e-01, 1.878180350243997543e-01,
                1.258415438273702280e-01, 6.875958050444919145e-01, 7.996067179474019015e-01, 5.735365651986431557e-01, 9.732299815994849279e-01, 6.340543771374785864e-01, 8.884217248114267829e-01, 4.954147587574643241e-01, 3.516165298902121927e-01, 7.142303685445205996e-01, 5.039291164479154927e-01, 2.256376065206394665e-01, 2.449744402418640998e-01, 7.928007000495905787e-01, 4.951724145113690634e-01, 9.150936733997764305e-01,
                9.453718338750177752e-01, 5.332322296552157725e-01, 2.524925945574266750e-01, 7.208620581748479417e-01, 3.674387637945772944e-01, 4.986484429110532579e-01, 2.265750474624558253e-01, 3.535656467460469576e-01, 6.508517866232056415e-01, 3.129328953051520035e-01, 7.687354471693397251e-01, 7.818371033712542273e-01, 8.524094829407250495e-01, 9.499057401519872545e-01, 1.073229122010441738e-01, 9.107253559654027164e-01,
                3.360551619124861888e-01, 8.263804268146445198e-01, 8.981006351198468352e-01, 4.271530433633308199e-02, 1.957949990887963843e-01, 2.945013219571044338e-01, 6.269998805719290136e-01, 8.622310512275210836e-02, 1.429450198122096394e-01, 5.158265192309317015e-01, 6.893413296582980854e-01, 8.566258107898887530e-01, 6.473616833221110811e-01, 5.816186755307398704e-01, 7.111159550984597066e-01, 2.524168570465248340e-01,
                9.001596834826075533e-01, 4.422936929062839528e-01, 2.052082465671201117e-02, 9.596610139968158038e-01, 6.522254224477255224e-01, 5.132062501046736891e-01, 6.823563831377039701e-01, 4.895403906291710960e-01, 9.264901712574321602e-01, 5.158797721686504412e-01, 7.215988173693121954e-02, 5.675082981990635655e-01, 6.152431837237443135e-01, 9.415462944696401104e-01, 4.153633547210029420e-01, 2.644399745754834052e-01,
                9.739316536577857786e-02, 4.858442218780016919e-01, 4.646628628609530409e-01, 2.975931699114220397e-02, 6.942774618573754886e-01, 7.169471123652260136e-01, 7.298114232911694366e-01, 4.143510171895457006e-01, 1.509884479415901648e-02, 9.089751574841472559e-01, 7.893787181103599782e-01, 1.651991691631765624e-01, 3.127859613262710115e-01, 6.109453058195960518e-01, 3.644902867188590800e-01, 1.560385892014994891e-01,
                1.773038134245518149e-01, 8.678896710470460629e-01, 2.900946684444934975e-01, 5.851796213146613912e-01, 4.539948759094689645e-01, 4.111781321725388461e-01, 8.826344451768417532e-01, 6.927080147947489719e-01, 2.792733551957504723e-01, 6.444023118528352523e-02, 1.986236137588489603e-01, 9.316827447029557563e-01, 8.544135677806904416e-01, 9.547347345609251690e-01, 5.225334824317295901e-02, 5.794716805909340129e-01,
                4.804962666491293666e-01, 2.170897897556423040e-02, 3.736204637343949475e-01, 4.140918011765591933e-01, 6.039072339140043599e-01, 6.717487273552374960e-01, 8.388657004383164306e-01, 7.795262083188739810e-01, 4.007010440412311914e-01, 7.945292313896830105e-01, 8.931243103976029829e-01, 2.624896908588915112e-01, 9.891970073781058970e-01, 8.533070990157378688e-01, 7.314771560377569815e-01, 3.555656247063535558e-01,
                8.832894907073365331e-01, 8.679590908270853333e-01, 9.557664458336379010e-01, 1.072565197369756973e-04, 1.654104191897465270e-02, 3.140700572587440398e-01, 9.953161745927157078e-01, 1.488442231559905515e-01, 1.673771187085043577e-01, 7.585720369179193012e-01, 6.952966615432309982e-02, 7.054734385962705412e-01, 4.691652817790955554e-01, 1.018821612531284337e-02, 7.748238628662620364e-01, 7.942010083604740256e-01,
                1.495694517458655559e-01, 2.370363179008894150e-02, 7.620637708943899247e-01, 2.236701798933443674e-01, 2.621743977651141977e-01, 4.568695027754948734e-01, 2.499269185070182031e-01, 5.682835615907467774e-01, 8.469429969102437727e-01, 3.780995370295705538e-01, 4.324651164320366670e-01, 8.326191762741114166e-01, 3.711319356941938929e-01, 4.055327192616220433e-02, 5.546714859719868995e-01, 4.512462428109201840e-01,
                7.253009767267311059e-01, 3.784505223145956387e-01, 8.406624957089063876e-01, 4.693146935836243205e-01, 5.626434290121736792e-01, 6.611993392450590257e-01, 4.622418675246713349e-01, 6.236369454887165098e-01, 2.218806311853600555e-01, 7.328631167551989956e-01, 3.816820886959958470e-01, 1.948345417705644733e-01, 2.711627747939684419e-01, 2.492250519628125272e-01, 1.521390622554665839e-01, 7.713737042013263379e-01,
                2.554117323639768511e-01, 1.275434050485344528e-01, 6.651671533226938271e-01, 4.128049486799827417e-01, 6.677677664388839140e-01, 6.598135170979930741e-01, 3.053776718774997567e-01, 2.012242410287502503e-01, 2.220271264991259264e-01, 1.199708633439309224e-01, 3.714544103026395927e-02, 3.413158352411926888e-02, 2.304965479145557605e-01, 2.283537064654975746e-01, 6.249106219248093952e-01, 8.925611854667612199e-01,
                7.797280162429423012e-01, 7.214512686280745157e-01, 3.104421590352526295e-01, 3.630834164231796501e-01, 1.960817838642895383e-01, 9.354917980336812100e-01, 5.617340001760203760e-01, 8.172915368907108791e-01, 3.489139809470056530e-01, 7.997142628236127981e-01, 1.041044625273416235e-01, 7.121201651273947331e-01, 9.174484959156598007e-01, 8.035853686291987152e-01, 3.271131462989578242e-01, 2.551071792638658353e-01,
                4.950021743571377808e-01, 4.136109542694667018e-01, 4.249370952927521428e-01, 7.437830484476892767e-02, 6.033906512895237384e-01, 7.471997335454725331e-01, 7.975762266608199536e-01, 3.815005225537928535e-01, 7.971581528204094713e-01, 4.717973696141896101e-01, 7.213991711446312571e-01, 1.892126892745024103e-01, 4.345957093796101178e-01, 8.234681090521418501e-01, 8.262726278651028045e-01, 1.895254834816282319e-01,
                2.010217015266313467e-02, 7.034913860559693921e-01, 3.472701194189391494e-01, 4.195038162234535628e-01, 7.680889031777187181e-01, 9.628780663042870724e-01, 8.925653069255604644e-01, 1.349422666740336396e-01, 7.978047149920718395e-01, 6.820906075403962987e-01, 5.300528871210843374e-01, 8.659816552061669892e-01, 7.532480953527282974e-01, 9.320258681925130961e-02, 3.294394320315702229e-01, 4.123626956328559912e-01,
                9.646077661084051513e-04, 5.975635631269651249e-01, 6.825615420825358326e-01, 3.662807615435281772e-01, 3.964988574269781019e-01, 4.753591455113127529e-01, 5.810799005432454312e-01, 1.371371278107637037e-01, 9.994141734640487051e-01, 5.073272087831909305e-01, 4.930667045457398645e-01, 1.868747550278784253e-01, 2.960880147636116844e-01, 7.985150592159274696e-01, 2.947782929373367056e-01, 6.971215933335274118e-01,
                2.729592287509264859e-01, 9.125284512654073810e-01, 2.985392337599013235e-01, 8.898597721036697328e-01, 9.467222937647236103e-01, 1.689128228710993218e-01, 3.592914057326346278e-01, 6.821773028712335707e-01, 9.213919700550423642e-01, 1.449243439942842215e-01, 9.987438495818057316e-02, 4.116027765716530062e-01, 9.751253707579931040e-01, 4.150654089868488494e-02, 1.869142945124901978e-01, 6.087679879960481433e-01;

    double rho = 0.95;
    double alpha = 0.1;
    double beta = 0.01;
    int num_features = 16;
    art::OnlineFuzzyART online_fuzzy_art(rho, alpha, beta, num_features);
    std::vector<int> clusters = online_fuzzy_art.run_online(features);
    for (const auto& c : clusters) { 
        std::cout << c << " ";
    }
    std::cout << "\n";
}